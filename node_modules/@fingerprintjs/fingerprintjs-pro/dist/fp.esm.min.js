/**
 * FingerprintJS Pro v3.8.5 - Copyright (c) FingerprintJS, Inc, 2023 (https://fingerprint.com)
 *
 * This software contains code from open-source projects:
 * MurmurHash3 by Karan Lyons (https://github.com/karanlyons/murmurHash3.js)
 */

import{__spreadArray as e,__rest as t,__assign as n}from"tslib";function r(e){for(var t="",n=0;n<e.length;++n)if(n>0){var r=e[n].toLowerCase();r!==e[n]?t+=" ".concat(r):t+=e[n]}else t+=e[n].toUpperCase();return t}function o(e,t){return function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(e,t)?e[t]:void 0}var i={default:"endpoint"},u={default:"tlsEndpoint"},R="Client timeout",a="Network connection error",c="Network request aborted",E="Response cannot be parsed",s="Blocked by CSP",f="The endpoint parameter is not a valid URL",d=/*#__PURE__*/r("WrongRegion"),l=/*#__PURE__*/r("SubscriptionNotActive"),_=/*#__PURE__*/r("UnsupportedVersion"),p=/*#__PURE__*/r("InstallationMethodRestricted"),O=/*#__PURE__*/r("HostnameRestricted"),v=/*#__PURE__*/r("IntegrationFailed"),I="API key required",h="API key not found",N="API key expired",T="Request cannot be parsed",m="Request failed",A="Request failed to process",w="Too many requests, rate limit exceeded",P="Not available for this origin",D="Not available with restricted header",y=I,S=h,L=N,U="3.8.5",g="9319";function C(t,n){var r=[];return function(t,n){var r=5,o=(E=t,f=e([],E,!0),{current:function(){return f[0]},postpone:function(){var e=f.shift();void 0!==e&&f.push(e)},exclude:function(){f.shift()}}),i=(R=100,a=3e3,c=0,function(){return Math.random()*Math.min(a,R*Math.pow(2,c++))}),u=o.current();var R,a,c;var E,f;if(void 0===u)return Promise.reject(new TypeError("The list of script URL patterns is empty"));var d=function(e,t){return n(e).catch((function(e){if(t+1>=r)throw e;!function(e){if(!(e instanceof Error))return!1;var t=e.message;return t===s||t===g}(e)?o.postpone():o.exclude();var n,u=o.current();if(void 0===u)throw e;return(n=i(),new Promise((function(e){return setTimeout(e,n)}))).then((function(){return d(u,t+1)}))}))};return d(u,0)}(t,(function(e){var t=new Date,o=function(n){return r.push({url:e,startedAt:t,finishedAt:new Date,error:n})},i=n(e);return i.then((function(){return o()}),o),i})).then((function(e){return[e,{attempts:r}]}))}var b="https://fpnpmcdn.net/v<version>/<apiKey>/loader_v<loaderVersion>.js",K=b,M="Failed to load the JS script of the agent";function B(e){var r;e.scriptUrlPattern;var i=e.token,u=e.apiKey,R=void 0===u?i:u,a=t(e,["scriptUrlPattern","token","apiKey"]),c=null!==(r=o(e,"scriptUrlPattern"))&&void 0!==r?r:b;return Promise.resolve().then((function(){if(!R||"string"!=typeof R)throw new Error(I);var e=function(e,t){return(Array.isArray(e)?e:[e]).map((function(e){return function(e,t){var n=encodeURIComponent;return e.replace(/<[^<>]+>/g,(function(e){return"<version>"===e?"3":"<apiKey>"===e?n(t):"<loaderVersion>"===e?n(U):e}))}(String(e),t)}))}(c,R);return C(e,F).catch(k)})).then((function(e){var t=e[0],r=e[1];return t.load(n(n({},a),{ldi:r}))}))}function F(e){return function(e,t,n,r){var o,i=document,u="securitypolicyviolation",R=function(t){var n=new URL(e,location.href),r=t.blockedURI;r!==n.href&&r!==n.protocol.slice(0,-1)&&r!==n.origin||(o=t,a())};i.addEventListener(u,R);var a=function(){return i.removeEventListener(u,R)};return null==r||r.then(a,a),Promise.resolve().then(t).then((function(e){return a(),e}),(function(e){return new Promise((function(e){return setTimeout(e)})).then((function(){if(a(),o)return n(o);throw e}))}))}(e,(function(){return function(e){return new Promise((function(t,n){var r=document.createElement("script"),o=function(){var e;return null===(e=r.parentNode)||void 0===e?void 0:e.removeChild(r)},i=document.head||document.getElementsByTagName("head")[0];r.onload=function(){o(),t()},r.onerror=function(){o(),n(new Error(M))},r.async=!0,r.src=e,i.appendChild(r)}))}(e)}),(function(){throw new Error(s)})).then(V)}function V(){var e=window,t="__fpjs_p_l_b",n=e[t];if(function(e,t){var n,r=null===(n=Object.getOwnPropertyDescriptor)||void 0===n?void 0:n.call(Object,e,t);(null==r?void 0:r.configurable)?delete e[t]:r&&!r.writable||(e[t]=void 0)}(e,t),"function"!=typeof(null==n?void 0:n.load))throw new Error(g);return n}function k(e){throw e instanceof Error&&e.message===g?new Error(M):e}var G={load:B,defaultScriptUrlPattern:K,ERROR_SCRIPT_LOAD_FAIL:M,ERROR_API_KEY_EXPIRED:N,ERROR_API_KEY_INVALID:h,ERROR_API_KEY_MISSING:I,ERROR_BAD_REQUEST_FORMAT:T,ERROR_BAD_RESPONSE_FORMAT:E,ERROR_CLIENT_TIMEOUT:R,ERROR_CSP_BLOCK:s,ERROR_FORBIDDEN_ENDPOINT:O,ERROR_FORBIDDEN_HEADER:D,ERROR_FORBIDDEN_ORIGIN:P,ERROR_GENERAL_SERVER_FAILURE:m,ERROR_INSTALLATION_METHOD_RESTRICTED:p,ERROR_INTEGRATION_FAILURE:v,ERROR_INVALID_ENDPOINT:f,ERROR_NETWORK_ABORT:c,ERROR_NETWORK_CONNECTION:a,ERROR_RATE_LIMIT:w,ERROR_SERVER_TIMEOUT:A,ERROR_SUBSCRIPTION_NOT_ACTIVE:l,ERROR_TOKEN_EXPIRED:L,ERROR_TOKEN_INVALID:S,ERROR_TOKEN_MISSING:y,ERROR_UNSUPPORTED_VERSION:_,ERROR_WRONG_REGION:d,defaultEndpoint:i,defaultTlsEndpoint:u};export{N as ERROR_API_KEY_EXPIRED,h as ERROR_API_KEY_INVALID,I as ERROR_API_KEY_MISSING,T as ERROR_BAD_REQUEST_FORMAT,E as ERROR_BAD_RESPONSE_FORMAT,R as ERROR_CLIENT_TIMEOUT,s as ERROR_CSP_BLOCK,O as ERROR_FORBIDDEN_ENDPOINT,D as ERROR_FORBIDDEN_HEADER,P as ERROR_FORBIDDEN_ORIGIN,m as ERROR_GENERAL_SERVER_FAILURE,p as ERROR_INSTALLATION_METHOD_RESTRICTED,v as ERROR_INTEGRATION_FAILURE,f as ERROR_INVALID_ENDPOINT,c as ERROR_NETWORK_ABORT,a as ERROR_NETWORK_CONNECTION,w as ERROR_RATE_LIMIT,M as ERROR_SCRIPT_LOAD_FAIL,A as ERROR_SERVER_TIMEOUT,l as ERROR_SUBSCRIPTION_NOT_ACTIVE,L as ERROR_TOKEN_EXPIRED,S as ERROR_TOKEN_INVALID,y as ERROR_TOKEN_MISSING,_ as ERROR_UNSUPPORTED_VERSION,d as ERROR_WRONG_REGION,G as default,i as defaultEndpoint,K as defaultScriptUrlPattern,u as defaultTlsEndpoint,B as load};
